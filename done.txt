Сделано:
 Ok. Сделать фон
	Сделать фон у body? или у canvas тега? или отрисовать в canvas?
	разрешение картинки 1988x882 (разрешение экрана 1920x1080) (разрешение chrome окна 1920x937)
		тобишь при разрешении экрана в 4k - будет некрасивая хрень
			при большем размере мы можем центрировать по центру картинку, а остальное заполнить чёрным
	Как будет происходить отображение фона при разных разрешениях и пропорциях?
		особенно при более меньших
			будем ли мы передвигать фон? или будем его обрезать? 
				двигать будет не удобно + бестолково, если нападение со всех сторон происходит
				* значит будем масштабировать в одинаковой пропорции с заполнением чёрным по краям
	Результат: отображаем в пропорции, заполняем фон затемлённой землёй
Ok. наведение на объекты
Ok. time цикл
Ok. Анимации
Ok. пропорции объектов
	ширина экрана 1920
	ширина летающей земли 500 (1/4 ширины экрана)
		1920 / 2 - 500 / 2 = 710 пикселей от границ экрана до земли 
Ok. текст от сбора монеток (+1) зелёным-лаймовым цветом
	Message.Add(messages, new Vector2(mouse.X - 10, mouse.Y - 10), new Message("+" + Coin.costGold));
	rgb(191,255,0)
Ok. структура js файлов
	Ok. нужно разделить функционал по canvas и game logic 
		скорей всего это будет базовый класс с функциями: draw, logic, init, hover, click

		как быть с множественными объектами?
			можно статичныый класс сделать, но тогда придётся постоянно копировать его функционл в новые классы

		WaveData класс

		Решено. расположение неверное, куда идут зомби (нет смещения на середину здания)
		Решено. монетки не собираются зомби
		Решено. урон не наносится зданию
Ok. создать отдельный index.html для тестов
	создать класс для тестов
Ok. меню
	можно ставить игру на паузу - тогда появится меню с пунктами "Продолжить", "Новая игра"
	если волна закончилась, то добавляются пункты "Магазин", "Новая волна"
	если игрок проиграл, то только пункт "Новая игра"
	Ok. добавить кнопку "Меню" в верхний левый угол
Fixed. есть баг с монетками - после выхода из паузы - они исчезают, т.к. они по createdTime удаляются.
	надо поменять на lifeTimeLeft
Ok. сделать несколько видов одного монстра (разные цвета? / небольшие различия?)
	Ok. модернизировать выбор изображения из существующих - лучше передавать скоп картинок внутрь класса Monster, а там рандомом выбирать?
Ok. добавить показ уровня волны
	Ok. 1-ая волна
Ok. добавить показ количества монстров на волне (просто сколько убито из всего) 0/500
Ok. после волный, показывать сообщение - 1-ая волна - пройдено.
	Ok. появляется кнопка магазина 
	Ok. и кнопка - начать следующую волну
Ok. Архитектурный момент по html:
	магазин стал сильно большим и там много функционала по добавлению/исчезновению элементов
	Ok. может пора использовать react?
			стоит ли использовать reduxe? 
				только для html? или для всего?
			Какой react? 
				native или продвинутый?
	Ok. Так же пора использовать less или sass для стилей
	Ok. TypeScript 
Ok. нужно использовать TypeScript что бы не было проблем с тонной ошибок
Ok.у магазина должно быть затемнение заднего фона
Cancel. добавить магазин (вариант 1):
	нужно расписать все возможности, которые можно купить

		> юниты 
			атакующие, 
				маги, лучники, воины
			собирающие монетки, 
			долбящие землю, 
			лечащие, 
				маги, врачи
			ремонтирующие

				* получают опыт для новых уровней, с каждым уровнем повышаются характеристики
				* можно прокачивать каждого юнита отдельно

		> баррикады (колья, стена деревянная)

		> оборонительные башни
			наземные
				 башня как в warcraft у орков, 
			на летающей земле
				 катапульта, 
				 балиста 

		> другие строения 
			магнит на сбор монет, 
			мед блок для лечения юнитов после волны
			бур
			энергетический барьер


		> улучшение клика (увеличение урона, коэффициент сбора монет увеличенный)
			сбор монет при наведении мыши,
			магнит на монеты для мышки

		> магия (
			вызов метеора, 
			улучшение защиты/атаки юнитов и построек на n секунд
			лечение юнита, 
			массовое лечение, 
			ремонт постройки)
cancel. магазин (вариант 2) (покупаются здания на острове + их улучшения, затем в самих зданиях покупаются их содержимое) 
	> храм - улучшения повышают силу клика и заклинаний 
		> пассивные
			> сбор монеток при наведении
			> магнит для монеток
			> поджигание врагов (горят долго)
			> замораживание врагов (медленно передвигаться будут)
			> удал электричеством (по цепочке передаётся)
			> увеличение добычи монет (визуально как желе - искривление пространства за счёт взрыва)
			> оставления чёрных дыр для автосбора монето на некоторое времяя
			> притягивание монеток к мышке 
			> магнитный импульс притягивания монет (нажимаешь и монетки подпрыгивают к мышке - главное мышку не убирать)
		> активные заклинания
			> метеорит
			> огненный дождь

			> заморозка
			> цепная молния
			> каменные шипы из под земли

			> лечение
			> ремонт

	> казарма - улучшения усиливают юнитов (при смерти юнитов - их можно воскресить за 10% от стоимость) 
		> рабы для сбора монеток
		> рабы для долбления земли
		> Леголаз - лучник (улучшения увеличивают скорость стрельбы и урон)
		> Паладин - юнит с щитом и мечом (улучшения повышают защиту и хп)
		> Берсерк - атакующий юнит с секирой (улучшения повышают урон, область атаки и хп)
		> Маг - атакующий юнит с жезлом (улучшения повышают урон, дают новые заклинания и увеличивают область атаки)
		> медсестра - лечит юнитов магией (улучшения повышают силу лечения и скорость передвижения)
		> Техник - чинит здания (улучшения повышают скорость восстановления зданий и скорость передвижения)
		
		> Терминатор (дорого) - атакующий робот на гусеничной платформе, сверху - пулемёт (улучшения повышают урон)
		> летающиая тарелка (очень дорого) - атакующий летающий юнит (атакует лучом) (улучшения повышают скорост полёта и урон)

	> строительная фабрика - улучшения увеличивают хп и защиту строений 
		> баррикады (деревянные)
		> стена (деревянная)

		> атакующие
			> башня наземная
			> башня воздушная
			> катапульта
			> балиста

		> бур (для добычи монеток)
		> магнит - для сбора монеток
		> энергетический барьер 

	> Исследовательский центр - позволяет изучать новые виды зданий, юнитов и магии, после чего появляются новые скины
		(надо подглядеть в других играх)
		1. ур (изначальный) - деревянные здания (башня варкрафта), юниты с копьями, луками, с деревянные щитами
			? 1.1 ур - укреплённые деревянные здания, юниты с каменными копьями
		2. ур - каменные здания (башня из казаков), юниты с мечами, арбалетами, улучшенными луками, железными щитами
		3. ур - стальные здания, юниты с мушкетами, саблями
		4. ур - бетонные здания, юниты с автоматами, гранатами
		5. ур - иновационные здания, юниты с лазерами, энергетическими щитами и гранатами


		отдельные улучшения?
			> повышение защиты зданий
			> повышение силы магии (у кликов и у  магических юнитов и зданий)
			> повышение урона юнитов
			> повышение защиты юнитов
			> 
В процессе. Магазин (Вариант 3) - гибрид варианта 1 и 2
	Минусы варианта 2 - необходимость строить здание перед покупкой
	Минусы варианта 1 - было бы классно построить храм на горе и казарму и завод (или нет?)
		Храм позволяет апгрейдить магию, силу клика и изучать новые заклинания
		Казарма позволяет апгрейдить юнитов и нанимать новых персонажей
		Завод позволяет апгрейдить строения и строить новые здания
Ok. добавить кнопку на начало новой волны
Ok. монстры должны разрушать постройки.
Ok. При уничтожении монстров добавить анимацию разлитания энергии вокруг,
	 как в игре Valheim
Ok. добавить анимацию разрушения башни
	Ok. (после 0 хр)
Ok. оживить башню - она должна стрелять по ближайшим врагам
Ok. добавить анимацию атаки башни (стрелой)
Ok. добавить затемнение объектов во время блокировки нажатий
Fail. добавить вибрацию земли при клике (добычи золота)
	[результат с вибрацией по горизонтале и по rotate оказался не очень]
Ok. в волнах выставить отсрочку появления каждого типа монстра, что бы более сложные выходили чуть позже
Ok. создавать монстров разного размера (в диапазоне) + разное хп от размера
	Ok. сделать отрисовку изображения меньше оригинала
	Ok. сделать движение наземных монстров по земле, а не по заданному y
Ok. добавить демо режим: мало монстров, высокая награда за них
Ok. связать скорость анимации со скоростью движения
Ok. сделать прыок кабана заметнее
Ok. сделать анимаю атаки кабанку
Ok. при строительстве отображать радиус стрельбы башни 
Ok. добавить звуки
			Ok. добавить настройки уровня звуков и музыки 
			Ok. постройка зданий: бух
			Ok. сбор монеток 
			Ok. выбр элементов меню
			Ok. добыча монетки
Fixed. в режиме строительства, при клике на магазин или меню - выбранная башня ставиться/строиться
Fixed. если поставить башню на середину, то монстры будут бить саму верёвку через башню
Fixed. При отображение надписи "Волна пройдена", если тыкнуть на "Новая волна", то будет тёмный экран пару секунд
	нужно принудительно завершать показ предыдущей надписи при появлении новой надписи.
Fixed. невозможно поставить более одной башни
Ok. добавить затемнение с прозрачным пропаданием пыли от строительства здания и взрыва здания
Ok. дать кабану спец способность +  анимация спец способности
	Ok. анимация облаков пыли при беге 
		Or создавать увеличивающуюся анимацию, и уменшать прозрачность
			каждые n пикселей создавать 
		Or создать 1 анимацию, котора будет перемещаться вслед за кабаном и будет зацикленной с n кадра
			до тех пор пока кабан движется
			90x44
			18 кадров
	Ok. передавать зданиям импульс
		Ok. добавить башне качание от импульса
	Ok. анимация отлёта ошмётков при столкновении 
	Ok. переработать систему срабатывания спец способности - она должна срабатывать в диапазоне, от N пикселей до цели до M пикселей до цели
	Cancel. можно поиграться с шейдерами canvas, что бы изобразить небольшую ударную волну  https://habr.com/ru/post/420847/
		всё оказалось намного сложней, getContext не поддерживает выдачу разных типов для одного canvas, 
			при этои, webGL canvas намного производительней, но и сложней в использовании....
			если хотим его использовать, то нужнен полный переход с 2d на webGL,
			так же в webGL можно сделать освещение через нормали https://developer.mozilla.org/ru/docs/Web/API/WebGL_API/Tutorial/Lighting_in_WebGL
				но трудозатраты на создание нормалей для каждого объекта - может быть через чур высоким
	Cancel. возможно так же стоить добавить доп анимацию атаки, т.к. обычное начало атаки выглядет неэффектно
Ok. отображать урон по юнитам красным цветом без минуса, при сборе монет или получения монет за
	уничтожение монстра - отображать жёлтым цветом + звук
	При покупке здания, плавно уменьшать количество монет на счету
Ok. отображать урон юнитов по зданиям
	Ok. обновить систему нанесения урона монстров, не раз в каждый цикл, а раз в n времени по анимации 
	Ok. всплывающие Label ? будет прикольно и плавно исчезающие, если так сделать все Labels?
	Ok. цветовую схему можно поменять, красный - урон зданиям, зелёный или фиолетовый - урон по монстрам
		Fail. отображать чёрный текст с белым контуром, иначе не видно совсем. - Белый превосходит чёрный 
			чёрный на красном - уже лучше, но тоже не катит в общей массе.
		Fail. зелёный, бирюзовый и фиолетовый смотрится отстойно.
		но красный по зданиям - классно и по монстрам тоже классно, но я не думаю что это хорошо смешивать
		может сделать разные оттенки красного?
		попробовать использовать перламутровый - который переливающийся, анимацией, но я не уверен, что это возможно сделать без шейдеров
Fixed. при надписе GameOver появляется дым у кабанов некоторых, у которых дыма небыло
	дело в smokeScaleSize
Canceled. можно поиграться с шейдерами canvas, что бы изобразить небольшую ударную волну  https://habr.com/ru/post/420847/
		всё оказалось намного сложней, getContext не поддерживает выдачу разных типов для одного canvas, 
			при этои, webGL canvas намного производительней, но и сложней в использовании....
			если хотим его использовать, то нужнен полный переход с 2d на webGL,
			так же в webGL можно сделать освещение через нормали https://developer.mozilla.org/ru/docs/Web/API/WebGL_API/Tutorial/Lighting_in_WebGL
				но трудозатраты на создание нормалей для каждого объекта - может быть через чур высоким
Canceled. может при клике тоже небольшое баловство с шейдером сделать?
Ok (50%). добавить эмоциональное вознаграждение за клик по мобу + за клик по летающей земле
	Ok (50%). добавить анимацию кирки при добычи золота (сияние кирки с блёском)
	Ok (50%). доработать анимацию меча при клике по мобу
Fixed. иконку категории в магазине можно перетащить - нужно добавить запрет на выделение
Fixed. когда долго не заходишь на вкладку, то звук первый долго появляется 
	- он заново грузится в кеш?
		да, судя по Network загрузкам
	- как загрузить аудио только 1 раз?
		нужно перетащить файлы в public папку?
		fail. а если к body Добавить динамически?
			document.getElementsByTagName('body')[0].appendChild(selectingSound);
			непомогло
				это из-за того, что аудио файл через new Audio вызывается?
				https://stackoverflow.com/questions/69760600/how-to-cache-a-webaudio-object-properly
	- эта проблема актуальна и для картинок?
		иконки курсора в base64 он почему то грузит заново, остальные картинки остатся актуальными
		для других картинок - неактуально
	- проблема исчезает, если в body создавать audio тег динамически и его использовать всегда для воспроизведения 
		> можно использовть этот метод + добавить проверку на статус. если нельзя воспроизвести, то создаём новый элемент 
			с новый id и в следующий раз уже выбираем между текущими элементами, который из них свободен 
			(брать элементы по классу+ фильтр по статусу)
			
			ended - закончил ли воспроизведение элемент 
			https://developer.mozilla.org/ru/docs/Web/API/HTMLMediaElement
	Ok. можно попробовать закачать аудио в буфер после загрузки 
		и в следующий раз создавать с буфера Audio объект, если это можно
fixed. иногда мобы "выплывают" из под земли
	monsterSize.height = 0, т.к. изображение не успело загрузиться для тестирования
	Monsters.ts -> init:
		this.typeSizes = {
			[Zombie.name]: new Size(Zombie.images[0].width / Zombie.imageFrames, Zombie.images[0].height),
			[Boar.name]: new Size(Boar.images[0].width / Boar.imageFrames, Boar.images[0].height)
		};
	этот код надо вызывать, когда завершилась загрузка требуемых каринок
Ok. добавить ещё одно строение: баррикада с шипами
Fixed. ничиго не происходит при попытки построить второй объект после перого, когда ещё label не пропал
Ok. при строительстве зданий, их нельзя друг на друга ставить. - нужно отображать красным, если место занято.
fixed. импульс не изменяет отображение других зданий 
fixed. картинка башни имеет висящую в воздухе заднюю-левую опору
Ok. при тестировании выявилось, что картинка может не успеть загрузиться перед началом использования, а потом уже будет поздно
	актуально только для test page. В самой игре идёт ожидание загрузки картинок перед запуском игры
		но при этом, было бы хорошо найти динамический способ загрузки картинок, во время самой работы игры. Ленивой загрузкой.
	частично сделано: пофиксить появление монстра на карте, ведь он появляется с учётом своей высоты
	возможно стоит разделить на картинки, которые нужны к началу игры и те, что могут грузится уже после, в процессе, до своего появления 
		> до своего появления - как это сделать? сейчас картинки в init методах грузятся в начале игры и игра не начнётся, пока некоторые из них не будут загружены
		> если интернет медленный, то lazy загрузка картинокможет только навредить, тем что будет задерживать начало появления некоторых объектов 
			в то же время, ничего плохого может и не быть, если картинка рано или поздно загрузиться...
			а если произойдёт ошибка загрузки картинки? надо же её перезагрузить
	картинка не отображается, потому что в конструкторе передаётся image.width внутрь родительского класса, 
		в width = 0, т.к. картинки ещё нет.
	Решение: 
		> либо контролировать создание объектов (если ещё не загрузился, то не создавать и писать лог)
			проблемы: на страницы тестирования это не прокатит
				контр решение: добавить проверку там 
		> после загрузки картинки, заново записывать размер картинки 
		Selected. брать размер картинки динамически - по get свойству с вычисляемыми значениями
			не у всех моделей, это значение берётся из картинки
			могут быть проблемы с производительностью
Ok. очередь загрузки картинок
	Ok. загружать background раньше начала игры 
	Ok. загружать здания (кроме первых) после окончания первой волный
		> добавить ImageHandler для зданий 
		Ok. Builder картинки 
	Ok. загружать Monsters картинки (explosion) после начала игры 
fail. Cancel. сделать дополнительные 2 разные окраски кабанов 
	(более коричневый с 2 белыми полосами, как у зебры, только шире, в виде молний)
	(и чёрный вариант с серыми пятнами)
Ok. добавить летучую мышку, которая будет летать не по прямой траектории, а зигзагообразно (падают, поднимаются,...)
	с разным количество падения и очень ломанной  тракекторией, что бы сложно было попасть мышкой по ней
	Cancel. настроить поиск целей для башни - только наземные 
	Ok. настроить поиск целей для мыши - только летающая земля и воздушные 
	Cancel. добавить доп окрасу - фиолетовую с чёрными полосами 
	Cancel. добавить доп окрасу - цвета кожи с оранжевым мехом на грудной клетке 
Fixed. земля некликабельна в тестах
	непроходит проверку 
		Waves.isStarted && Waves.delayStartLeftTimeMs < 0
Fixed. если поставить на паузу, то некоторые монстры достаточно далеко переддвигаются при возврате 
	надо ограничить delayMillesecond в 1 секунду

Ok. ремонт строений (кроме главного здания?)
	Ok. иконка молоточка в рамке, при наведении на строение 
		Ok. при наведении должна отображать необходимое коилчество монет для починки = 1/10 от стоимости * (maxHealth - health)
		Ok. при клике - 
			Ok. починить и 
			Ok. потратить монетки + 
			Ok. label потраченных монеток и 
			Ok. звук монеток и починки (стук молотков)
			Ok. анимация починки
	Ok. иконка настроек рядом для upgrade окна 
	Ok. здание должно светиться при наведени, и клик должен открыть окно upgrade
	Fixed. нельзя ударить по мышкам, в области летающей земли
Ok. не отображать занчки ремонта и апгрейда пока идёт затеменение после волны
Ok. анимация за другими строениями появляется и за полоской здоровья. нужно вывести на передний план её.
Fixed. Обновить demo для третей волны 
Fixed. анимацию молотком поменять - сделать более быстрей и наклон молотка поменять
Done. на Enter не начинается игра и нет выбора пункта меню на стрелочки
fixed. иконка обновления перемещается, если зажать мышку и утащить
fixed. если открыто окно апгрейда, то Escape закрывает его, но и открывает меню сразу, что неправильно
fixed. кнопка апгрейда отображается при открытом окне апгрейда 
fixed. если при открытом окне пгрейда тыкнуть на ремонт, то в самом окне апгрейда данные останутся старыми
fixed. неудобно что при клике на кнопку ремонта или апгрейда, нужно убрать мышку со здания и заново завести, что бы появились кнопки заново
fixed. при клике на другом строении, анимации апгрейда остаются
Done. создать класс анимации (входной параметр: картинка, кол-во фреймов, время за которое все фреймы должны выполниться)
	внутри так же будет время начала анимации 
	
	(текущее время - время начала) % timeToShowAnimation / (timeToShowAnimation / frames)
	1577826000000 (1 jan of 2020 00:00:00) - 1577826060000 (1 jan of 2020 00:01:00) = 60000
	1 минута времени 
	frames = 60 
	timeToShowAnimation = 60000
	
	60000 % (60 * 60000) / 60 = 1000
	let frame = Math.floor((Date.now() - timeStart) % durationMs / (durationMs / frames));
Ok. отображать урон башни в информации + радиус действия + скорость стрельбы 
Ok. подсвечивать обновляющееся здание (можно анмацию под зданием - светящееся облако жёлтое)
	Ok. удалить пустое пространство по бокам каждого фрейма
	Cancel. Уменьшить кол-во кадров в 2 кадра
	Cancel. удалить середину анимации во всех кадрах
Ok. в классе зданий нужно добавить функцию которая будет возвращать список dictionary характеристик 
Ok. добавить возможность перемещения окна апгрейда
fixed. в магазине монетки затеменены
fixed. есть некий кейс, стабильно воспроизводится, но только по определённой траектории движения мыши 
	http://localhost:3000/test?v=20
	мышью с левой баррикады передвигаем строго вправо без наклона, до середины башни с умеренной скоростью (не быстро)
	значки аппгрейда и починки у баррикады исчезают, а у башни они не появляются, даже при движении мыши внутри башни 
	
	баг воспроизводится если 2 строения перекрёстно налагаются друг на друга 
		движемся мышкой в зону налажения 
		кнопки с первого строения пропадают (т.к. кнопки в единственном экземпляре существуют) 
			и появляются на строении 2 (у них просто стили меняются на местоположение второго здания)
		при выходе мышки из зоны второго здания, но всё ещё находясь в пределах первого здания, кнопки теряются (
		
			BuildingButtons отображается всегда, а скрывается за счёт стилей для wrapper, 
				размер и позиция которого задаётся размеру и позиции здания (opacity: 0, а при hover: 1)
		
			мешает условие if(!this._isDrawButtons){
			т.к. мышка не выходила из зоны первого здания 
			
			fixed. только сейчас на зонах пересечения логика фигачит много в BuildingButtons, но визуально это не проявляется.
Ok. может перенести затемнение экрана для меню в Game.drawAll функцию? 
	это позволит только 1 раз затемнять область + можно будет количество монеток в интерфейсе выводить после затемнения для магазина
	но монетки нужны только для магазина
fixed. после починки здания - не отображается кнопка модернизациия здания
	вызов BuildingButtons.hide(); в onClickRepair of BuildingButtons.tsx создаёт этот баг 
fixed. при клике на Меню кнопку - первый пункт оказывается выделен, хотя мышка ещё не заходила туда  
fixed иконки ремонта и апгрейда проседают при разрешении экрана меньше 1200 
	- так же они разные для разных по высоте зданий 
		может сделать их одинакового размера?
fixed. при закрытии окна апгрейда, при наведении на то же здание - нету кнопки апгрейда (пока не наведёшь на другое здание)
fixed. пропадает звук, иногда вылечивается заходом в меню 
	сценарий: тыкать на добычу монеток до прихода мобов к канату (ошибок в консоле нету)
	может хром блочит за спам?
		ended событие не срабатывает у таких записей без звука
Ok. зомби
Ok. кабаны
	способность: с 30% встаёт и как бык начинает землю задними копытами гребсти, а потом бежит с пылью и 
		врезается нанося 10-ти кратных урон.
		+ добавить анимацию шатания башни от такого удара.
Ok. летучие мышки
	летят не по прямой траектории, а зигзагообразно (падают, поднимаются,...)
Ok. сделать воспроизведение анимации за указаное время, а не хаотичное исполнение - оно пропускает кадры и не факт, что кадры идут друг за другом)
Ok. синхронизировать анимацию атаки с частотой нанесения урона
fixed. когда землю разрушают _buildingGoal = null при попытке обратиться к .width  в Monsters логике: this.x > this._buildingGoal.x + this._buildingGoal.width - this.width / 5
	this._buildingGoal имеет проверку сыше на null 
fixed. при клике на начало новой волны - надо скрывать меню апгрейда
fixed. если навести на параметр радиус атаки и зажав кнопку апгрейда увести мышку быстро, то радиус остаётся висеть
	disabled кнопка ломает логику вхождения/покидания мышки (спасли другие события мышки: onMosueOver/Out заместо onMouseEnter/Leave)
ok. upgrade башни: 
	ok. добавить кнпоку ремонта к характеристикам хп
		Ok. настроить стили 
	ok. прокачка каждой характеристики в отдельности (колв-во уровней у характеристики + стоимость каждого уровня)
		ok. при наведении показывать стоимость слева 
			ok. если нехватает - показывать красным цветом 
		ok. кол-во потраченных монеток не видно
			Ok. Нужно что бы был не 1 label, а несколько
		ok. добавить звук оплаты
		ok. если недостаточно монеток - disable кнопки
		ok. нужно что-то придумать с наездом текста в Здоровье, если оно неполное
		ok. set яркий style with transition затуханием цвета после апгрейда и ремонта
			ok. как получить текущий элемент? 
			ok. как установить цвет моментально, а потом убрать с затуханием?
				убрать transition
				установить зелёный цвет 
				установить transition
				убрать зелёный цвет
				
				transition: background-color 2s ease;
				background-color: #12a300 !important;
				
				ok. но нужно проверить как будет выглядеть при нескольких быстрых апгрейдах
		ok. при апгрейде здоровья, ремонт удешевлется, т.к. он ведёт расчёт на основе первоначальной цены строения
		ok. при наведении на "Радиус атаки" - показывать этот радиус, как при строительстве 
			ok. MouseIn mouseOut событие на элементе + функции эти в ParameterItem, гду в Tower в них будет записывать true/false для отображения радиуса
		ok. добавить "Защита" и иконку щита (не добавлять улучшение этой опции - оно будет происходить через отдельный скилл)
		ok. уменьшение скорости перезарядки - надо подумать как это ограничить, бесконечно ведь не стоит давать, может уменьшать в процентах от текущего числа?
			или уменьшение в n раз ?
		ok. может improve points - не нужно передавать ? коли у нас функция improve есть....
		ok. прокачка количества лучников - должна увеличивать кол-во разных target-ов при условии, что есть разные монстры 
			иначе пусть одну цель долбят 
		ok. так при разные таржетах должны выбиратся разные типы мобов по земля/воздух
		cancel. добавить башни возможно изменять target  (клик на башню - клик на моба)
			причина: игрок будет терять время кликов на таржетирование целей, которые башня может уничтожить за 1 выстрел - в чём логика? только мешать будет....
			> проверить что бы небыло нечайных нажатий (хотел по мобу, а попал на башню)
			> таржет при разном кол-ве лучников (по порядку таргетировать каждого лучника)
fixed. когда недостаточно монет, цена ремонта сама отображается всегда на панели апгрейда здания и эта цена чёрного цвета, а не красного
ok. добавить 4 звука выстрела стрелой
	если объеденить arrowStrike2Sound и arrowStrike4Sound в один звук то более менее сносно, но при мноожественных башнях и лучниках нужно разбовлять...
		если заменить arrowStrike2Sound на более качественный звук полёта стрелы то будет то что надо
	ok. добавить замедление/ускорение аудио потока 
		ok. для стрел связать это со скоростью стрел
fixed. нужно сделать чёрным фон фона в магазине, т.к. при переключении на другую вкладку, картинка ещё не успела загрузиться и отображается на секунду жёлтый фон. сильное моргание. чёрный помог бы сгладить
fixed. при открытии магазина картинки с широких нормализуютсяв нормальные (видно моргание на эту 1 секунду)
	на это влияет стиль object-fit: contain
	заменил на background стиль
ok. добавить 4 звука меча 
fixed. звуки меча слишком разные, это бьёт по уху. один звук намного лучше воспринимается. 1 или 3 файл звука
	> при множественным ударах разные звуки как буд то не доигрывают до конца, непонятность возникает со звукми, иллюзия прерывания звуков
	заменил на 1 звук, но на кждоый волне он меняется - надо будет проверить - норм или нет при игре?
done. внедрить panner - это сделать звучание объёмным, использовть setPosition для pannerNode
	ok. звуки с левой стороны экрана должны идти преимущественно на левую колонку/наушник, а звуки с право соответственно на правый аудио выход
	Норм, сойдёт пока. главное не переборщить, что бы звук полностью не пропадал на одном из ух, хотя надо эксперементировать...
	ok. Большая проблема: координаты привязаны к координатам внутри canvas, это не равно координатам мыши и само окно браузера может быть уменьшено и перенесено в другую часть экрана, что делать?
		можно не привязываться к экрану, а привязаться к Canvas и пофиг.
ok. может разработать систему лёгкой модификации звка рандомным способом?  что бы не добавлять по 4 каждого звука, а пусть они сами при воспроизведении рандомно модифицируются в буффере
это сэкономит кучу памяти и трафика на хагрузку контента + кучу времени на разработку игры и сильно разнообразит звук, т..к. сейчас 4 звука меча - недостаточно при частых закликах по толпе 
	> имеющиеся по 4 вариации звуков
		норм (там из набора взяты звуки). удар киркой 
		> стрела 
		оставлен один. взрыв монстра 
		оставлен один. удар мечом 
	ok. IIRFilterNode
			пропускает всё в неизменном виде (магнитуда = 1, оба графика линейны)
				1
				1 
				
			понижает громкость до 10%  (магнитуда = 0.1, оба графика линейны)
				0.1
				1 
				
			слегка повысило громкость (магнитуда = 2, оба графика линейны)
				2
				1
				
			стало тише (магнитуда = 0.667, фаза = 0, оба графика линейны)
				1
				1.5
				
			пропускает всё в неизменном виде (магнитуда = 1, фаза = 0, оба графика линейны)
				1.5
				1.5
				
			слегка повысило громкость (магнитуда = 2, оба графика линейны)
				1
				0.5
				
			подняло громкость отдельный частот до слышимого состояния (магнитуда = 3, оба графика линейны)
				1.5
				0.5
				
			подняло громкость всех частот до слышимого состояния (магнитуда = 10, оба графика линейны)
				2
				0.2
				
		Итог: нижнее число уменьшает магнитуду, верхнее - увеличивает	
			фаза наинает меняться только при появлении второго числа
			
			магнитуда после 22000 начала рости с 1 до 8, а на 24000 герц улетела в космос 
			фаза геометрически вырастает до 1.57 к 24000 герц (1 = 23600 герц, 0.1 = 17600)
			звуковых измменений нету
				1.1   1
				1     1
				
			тоже с магнитудой
			фаза так же, но в отрицательную сторону направлена
			звуковых измменений нету
				1 	1.1
				1   1
				
			магнитуда = 1.1, линейна
			фаза = 0, линейна
			звуковых измменений нету
				1.1  1.1
				1 	 1
				
			магнитуда = 2, линейна 
			фаза = 0, линейна
			звуковых измменений нету
				2    2
				1 	 1
				
			магнитуда после 18700 начала рости с 2 до 76, а на 24000 герц улетела в космос 
			фаза плавно вырастает до 1.57 к 24000 герц (1 = 20800 герц, 0.5 = 15700, 0.2 = 8400,0.1 = 4500)
			некоторые звуки стали чуть громче
				2    1
				1 	 1
				
			так же как предыдущее, только магнитуда к 145 выросла, а фаза стала линейно от 0 к 1.5
			звуковых измменений почти нету
				2    0,1
				1 	 1
				
			тоже но фаза отрицательна от 0 к -1.5
			звуковых измменений почти нету
				0,1  2 
				1 	 1
				
		Итого: кол-во ззначений влияет на колв-о точек воздействия на трек, но чем  больше, тем тяжалее получить хоть какой-то нормальный звук
			значения всяким непредсказумемым образом меняют магнитуду и фазу, делаяслышимыми какието звуки попадающие под фильтра
		
		
	ok. https://gist.github.com/chrisguttandin/e49764f9c29376780f2eb1f7d22b54e4
		> OfflineAudioContext
			> startRendering
			работает как создание буффера - для фильтрв не годится
				ошибка different audio context.
					
	> https://developer.mozilla.org/en-US/docs/Web/API/Web_Audio_API
		> https://developer.mozilla.org/en-US/docs/Web/API/Web_Audio_API/Advanced_techniques
		
		> AudioWorklet - для фоновой обработки https://developer.mozilla.org/en-US/docs/Web/API/Web_Audio_API/Using_AudioWorklet
		
		> WaveShaperNode https://developer.mozilla.org/en-US/docs/Web/API/WaveShaperNode
			требует массив на вод

		> PeriodicWave https://developer.mozilla.org/en-US/docs/Web/API/PeriodicWave
			> Для оксилиратора, требует 2 массива на вход 
				var realCoeffs = new Float32Array([0,0]); // No DC offset or cosine fundamental freq
				var imagCoeffs = new Float32Array([0,1]); // sine of amplitude 1 at fundamental freq (First imaginary coeff is ignored)
				var wave = context.createPeriodicWave(realCoeffs, imagCoeffs); // will be a simple sine wave	

		> DynamicsCompressorNode https://developer.mozilla.org/en-US/docs/Web/API/DynamicsCompressorNode
		
		> examples: https://github.com/mdn/webaudio-examples
		
		ok. ConvolverNode  https://developer.mozilla.org/en-US/docs/Web/API/ConvolverNode
			эховый отголосок звука, как призрак. Для использования нужны импульсные буфера. пока не вижу где это можно применить.

		ok. BiquadFilterNode https://developer.mozilla.org/en-US/docs/Web/API/BiquadFilterNode
			непоспевает фильтр сгенерироваться.. есть небольшие задержки иногда
			
			lowpass
			frequency from 12000 to 24000
			Q from  1 to 15
			слух: почти нет отличий
			
			highpass
			frequency from 0 to 125
			Q from  0 to 15
			слух: почти нет отличий, после 200 frequency слышна барабанная дробь
				более бассовый чем lowpass
			
			bandpass
			слух: не удалось нормально настроить, сильно срезает звук при любых настройках
			
			lowshelf
			frequency from 1000 to 24000
			gain from  0 to 4
			слух: есть небольшие отличия
			
			highshelf 
			frequency from 5000 to 24000
			gain from  0 to 10
			слух: есть небольшие чёткие отличия
			отличия как шлепки или дождь по линолиуму
			
			peaking
			frequency from 12000 to 24000
			Q from  1000 to 2500
			gain from  0 to 10
			слух: при завышении gain до 700 слышны писки, длина которых зависитот Q
			при меньших значениям различий не слышно, кроме рандомного delay запуска трека
			
			notch
			frequency from 1000 to 24000
			Q from  1 to 200
			слуш: отбивание мяса молотком (с этими параметрами более менее незаметно)
			
			allpass
			слух:различия не обнаружились
			
			ok. рандомный вариант по разным типам
			
			ok. tone.js
			
			ok. провести сравнительный анализ на слух
				есть почти незаметная разница, очень долго пришлось прислушиваться, что бы разлечить, 
				что с рандомизацией звук разбавляется и уже не одинаков, но в чём отличия почти 
				невозможно разобрать, очень изредка то басовы, то свистовы звук проскакивает
				
	> https://tonejs.github.io/
	
	> https://howlerjs.com/

ok. добавить звук пустого мохания меча в воздухе
ok. звук уничтожение здания
ok. добавить звук исчезновения монстров 
ok. покупка элемента в магазине
ok. удары монстров по зданиям
ok. проверить когда все ресурсы загружаются и составить карту здесь.
	ok. images   (поиск по "/assets/img/")
		ok. FlyEarth.image -> Game.init
		ok. FlyEarthRope -> Game.init
		ok. Coin -> Game.init
		ok. Barricade.image Game.loadResourcesAfterEndOfWave endedWave == 0
		ok. Tower.image Game.loadResourcesAfterEndOfWave endedWave == 0
		ok. Tower.imageArrow -> Game.loadResourcesAfterBuild building == Tower
		ok. Tower.upgrade icons -> need to load Game.loadResourcesAfterBuild building == Tower
		ok. Wave.monstersIcon -> Game.init
		ok. Builder.smoke -> Game.loadResourcesAfterEndOfWave endedWave == 0
		ok. Buildings.explosion -> Game.loadResourcesAfterBuild
		ok. Building.hummer -> Game.loadResourcesAfterEndOfWave if buildings.all.finx(x => x.health < x.healthMax)
		ok. Building.upgrade -> Game.loadResourcesAfterBuild 
		ok. Building.HealthIcon -> Game.loadResourcesAfterBuild 
		ok. Building.ShieldIcon -> Game.loadResourcesAfterBuild 
		ok. Monsters.explosion -> Game.init
		ok. Bat -> Wave.startNewWave if monster in current wave
		ok. Boar -> Wave.startNewWave if monster in current wave
		ok. Boar.attack -> Wave.startNewWave if monster in current wave
		ok. Boar.special -> Wave.startNewWave if monster in current wave
		ok. Boar.specialSmoke -> Wave.startNewWave if monster in current wave
		ok. Boar.specialDamageParticles -> Wave.startNewWave if monster in current wave
		ok. Zombie -> Wave.startNewWave if monster in current wave
	ok. sounds   (поиск по "/assets/sounds/")
		ok. FlyEarth.pick -> Game.init
		ok. Tower.arrow -> Game.loadResourcesAfterBuild building == Tower
		ok. Building.hummer -> Game.loadResourcesAfterEndOfWave if buildings.all.finx(x => x.health < x.healthMax)
		ok. Building.repair -> Game.loadResourcesAfterEndOfWave if buildings.all.finx(x => x.health < x.healthMax)
		ok. monster.hit1-11 -> Game.loadResourcesAfterStartOfWave startedWave == 0
		ok. Builder.build -> Game.loadResourcesAfterEndOfWave endedWave == 0
		ok. Buildings.explosion -> Game.loadResourcesAfterBuild
		ok. Coints.get_coin -> Game.init
		ok. Game.sword_empty -> Game.loadResourcesAfterStartOfWave startedWave == 0
		ok. Monsters.explosion -> Game.init
		ok. Monsters.sword_attack -> Game.init
		ok. Menu.select -> Game.init
			ok. buildingButtons.select  -> Game.init (loaded in Menu)
			ok. Shop.select -> Game.init (loaded in Menu)
			ok. Upgrade.select  -> Game.init (loaded in Menu)
		ok. Upgrade.improve -> Game.loadResourcesAfterBuild
		ok. Zombie.sounds -> AudioSystem.play 

		Game.init запускается после открытия страницы с игрой, где меню с одной кнопкой отображается
ok. добавить 10 звука зомби и рандомно производить их в рандомное время при наличии зомби 
ok. сделать загрузку данных (картинок и звуков для следущей волны во время текущей волны)
	> после постройки здания - грузятся звуки для этого здания
	> звуки ударов - должны грузиться во время первой волны 
	> звук взрыва здания - после постройки первого здания 
	проверить все остальные звуки (поиск по "/assets/sounds/")
ok. сделать привязку громкости удара от damage
ok. добавить 10 звук ударов по зомби 
ok. добавить 10 звука хрюканья кабанов при ударе их мечом
ok. добавить 10 звука хрюканья кабанов
		sound3 - strange
		sound11 - как кудаханье
fixed. в меню можно юзать кнопки ремонта и апгрейда при наведении
ok. добавить звуки спец способность кабана
	ok. останавливать звук бега вместе с остановкой спец способности, как это сделать?
	ok. изучить звуки откладывающиеся по времени 
	ok. добавить проверку перед запуской бега - жив ли кабан ещё? 
	ok. останавливать звук бегапри гибели кабана 
	ok. останавливать звук копыт при гибели кабана
fixed. если посавить на паузу, когда кабаны уже бьют канат и потом снять с паузы - то канат получет от кабанов усиленный урон, как при спец ударе
	с зомби то же вроде больше урона идёт
	> lastAttackedTime основывается на временеи, поэтому после паузы - это время соответственно уходит
	лучше заменить на -= drawsDiffMs
fixed. проверить влияние biquad фильтров на загрузку цп, возможно стоит отказаться от его использования? либо навесить проверку на фпс, что бы отрубать фильтры при понижении фпс
	или через увеличение задержки применения фильтров добиваться улучшения фпс 
	var lastTimeUsedBiquadFilters 
	var delayBetweenBiquadFilters
	припонижении среднего фпс за последние 10 проверок - увеличивать delayBetweenBiquadFilters пропорционально упадку фпс, и обратно - при ровно 60 фпс - уменьшать delay плоть до его отключения
fixed. похоже что _getDistortionCurve больше всех проблем создаёт
	с фпс норм, но теперь звук отрубается
	с отключенным использовнаием _getDistortionCurve - всё норм.
ok. при окончании игры и при открытии меню - нужно ставить звуки boar на паузу
	https://stackoverflow.com/questions/11506180/web-audio-api-resume-from-pause
	fixed. Failed to execute 'start' on 'AudioBufferSourceNode': cannot call start more than once.
	нужно пересоздавать soruce для перезапуска
	если source.buffer - содержит уже изменённые данные под фильтрами, звуком, ... то можно просто с ним пересоздать - иначе надо записывать в source вызов функции _play с теми же самимы параметрами при старте 

	ok. нужно отколибровать и протестить по отдельности delay и offset для каждого элемента 
fixed. проверить все Date.now() - может ли что то ещё порождать проблему на паузе ?
	fixed. labels
	fixed. Animation 
	fixed. Wave 
	fixed. Boar 
	fixed. Builder
	fixed. Building 
	fixed. Monster 
ok. нужно поменять структуру файлов, она неудобна в текущей варианте 
	(нужно логически держать карту в голове, что бы понимать что где лежит, лучше группировать по названию (label, coin, wave, ...), а не по смыслу (system/model/object...)) 
	ok. нужно объеденить всех монстров в одну папку вместе с Monster.ts and Monsters.ts 
	ok. нужно объеденить все строения в одну папку вместе с Building.tx, Buildings.ts and Builder.ts
	ok. Waves + WaveData
	ok. Coins + Coin
	ok. Gamer + Mouse + Cursor + Keypad
	ok. Labels + Label
fixed. после рефакторинга, у кабана исчез дым, хотя анимация дыма вызывается 
ok. именование полей связанных с временем (секунды, миллисекунды, unixtime)
	ok. стоит ли в конец добавлять обозначение Ms, Sec, UnixT ? 
	или полное Milliseconds, Seconds, UnixTime ? 
	или вообще не добавлять в название, только комментарием в описании поля (через /** */)? 
ok. навести порядок в ветках гита
	canceled. удалить лишние 
	canceled. привести версии к 0.1+ 
	ok. проверить что нет неучтённых изменений 
		ok. если есть - описать их тут 
		неучтённые ветки:
			simpleReact - can be deleted
			FlyEarchVibration
			shaders
			animatedSimpleObject - can be deleted
		
		учтённые ветки:
			v0.1
			react_typescript_scss_redux
			v0.2
			v0.00001
			boar_special_ability
			boar_smoke
			building_repair
			upgrade-tower - can be deleted
			v0.4
			v0.5
			v0.6
			v0.7
			sounds
			v0.8
			v0.9
			v0.10
			improvments
			explosion_earch
			v0.11
			v0.12
			monster_necromancer
			v0.13
ok. проверить доступность свойств классов, может их закрыть private или только для чтения сделать readonly...
	ok. закрыть только технические поля, используемые в логике, 
	ok. а поля свойства и другие - открыть
	ok. private методы и поля должны именоваться с нижнего подчёркивания: _improve
		canceled. публичные отделить от закрытых
			объеденены по смыслу
	ok. статичные - не меняющиеся поля можно в readonly константы класса вынести
fixed. http://localhost:3000/test?v=15 (на 6-й раз воспроизводится) проблмеа наблюдается только с левой стороны
	был 2 раза пойман баг, что кабан пробегает мимо баррикады 
	зомби так же проходит иногда мимо, до рефакторинга времени такого небыло
	у FlyEarthRope x = 0
canceled. explosion in buildings/monsters поменять на new AnimatedObject
	сейчас это SimpleObject с size и location 
	у них разная логика отрисовки
ok. нужно делать рандом боле предсказуемым
	ok. пример с кабаном - нужно рандомом задавать заранее место с которого кабан будет спец способность активировать 
	ok. пример с волнами - рандомом задавать время через которое будет следующий монстр создан
fixed. анимация вращения частиц при просмотре данных строения- зависает через время
ok. добавить 10 звука хлопанья крылышками для летучей мышки
	ok. если больше 3 мышей на карте, то можно множественные звуки воспроизвоить, иначе - одиночные
canceled. звуки ходьбы зомби нужны?
canceled. звуки бега кабана без спец способности нужны?
ok. отколибровать все звуки между собой для единой гаммы
ok. добавить звуки
	canceled. падение монетки
	canceled. монетка собрана монстром 
	ok. спец способность кабана
	ok. удар спец способности кабана 
canceled. появилась проблема с зависанием вкладки браузера при горячем обновлении кода
	no. отключить фильтры и проверить проблему 
	no. отключить звуки и проверить проблему 
		баг воспроизводится
	no. может дело в версии NodeJs ? было сделано обновление NodeJs до последней подверсии в версии v14 
	ok. скачки по комитам выявили, что проблема появилась с комитом:
		refactoring + pre-load images and sounds (10.12.2022)
			hide sound after hiding browser tab (10.12.2022) - зависаний нету
			v0.6 - зависания уже есть
	> проблема воспроизводится только при обновлении Monster файла
		если закоментить строку: Monster.loadHitSounds();
		в Game.loadResourcesAfterStartOfWave
		то при обновлении Monster - проблема более не воспроизводится 
		если закоментить всё содержимое Monster.loadHitSounds функции то проблема все-равно актуальна 
		> видимо код не является проблемным, сам процесс горячего обновления крашится 
			с закоменченым кодом есть ошибки в консоли:
				The time must be greater than or equal to the last scheduled time
			может быть это связано?
			
			at assert (Debug.ts:8:1)
			at StateTimeline.add (Timeline.ts:88:1)
			at StateTimeline.setStateAtTime (StateTimeline.ts:54:1)
			at Player.start (Source.ts:193:1)
			at Player.start (Player.ts:178:1)
			at AudioSystem.ts:321:1
			at Array.forEach (<anonymous>)
			at AudioSystem.resumeSounds (AudioSystem.ts:310:1)	
		ошибку пофиксил, но проблема ещё осталась...
			если не обновлять файл монстров, то может норм?
			темболее это только для develop режима проблема
ok. для кнопки улучшения здоровья - цену показывать не сбоку, а сверху, если есть кнопка ремонта
	или лучше - отображать 1 кнопку, если нужен ремонт - то кнопку ремонта.
ok. добавить 3 звука писканья летучей мышки при ударе её мечом
	короткие звуки писка мышей
ok. добавить звуки для Game Over
	-тут-ту-тууууу
ok. начало новой волны - отдельный звук
fixed. resume - на музыке сейчас не работает, она начинает заново играть
	удалено использование нативного AudioBufferSourceNode. только Tone
fixed. после resume - нужно звук как-то обратно поместить в список класса для вызова stop 
	в resume пересоздаётся объект - ли может сам объект подменить что бы ссылка продолжала указывать на верный объект?
	удалено использование нативного AudioBufferSourceNode. только Tone
ok. система автовоспроизведения следующего трека пока завершения текущего
canceled. добавить дерзкую и энергичную фоновую музыку в режиме игры на тихом, ели заметном уровне
	звуков итак много, мне кажется лишь звуковой хлам будет, лишня нагрузка на слух
canceled. добавить фоновую музыку в меню (начинается с нарастаием до заданных показателей) штук 10 композиций разных
	мне кажется в меню это мешать будет. меню нужно для паузы и отойти от компа - звуки и музыка излишни тут
ok. добавить веcёлую и радостную музыку между волн
	> если будут проблемы с воспроизведением следующего трека, то можно добавить logic в MusicSystem и вызывать из Game всегда, а внутри пусть он уже сам определяет - что происходит и как ему реагировать ...
ok. Добавить иконку отключения звука (снизу, в правом углу во время меню)
	она меняет общу громкость на 0 или обратно на предыдущий уровень 
	при изенении ползунка, конка так же должна реагировать 
	иконка должна быть только в магазине и в меню (при заходе в настройки - исчезает ? надо глянуть, может пусть будет )				
canceled. добавить настройки в меню (кажется это излишнее - я ниразу в играх не трогал эти настройки)
	> общая громкость 
	> громкость звуков 
	> громкость музыки
	> ползунок мощности пространственного звука вплоть до отключения (от 0 до 1)
canceled. обломки от ударов по башне (излишне)
	canceled. добавить отлёт ошмётков при ударе по канату мобами
canceled. добавить анимацию искр золотых при добычи золота [нейтральная польза, возможно, стоит отказаться от этой идеи]
fixed. после нажатия на ремонт в окне апгрейда здания, кнопка ремонта продолжает отображаться на самом здании при наведении
ok. в тестах отображать список всех тестов и заменить на i++ в switch case 
ok.улучшения
	ok. отображать картинку апгрейда скила
		ok. название 
		ok. кнопку покупки со стоимостью
		ok. внизу центрированно отображать улучшения в виде одних только цифр и иконок
			+1 <иконка человечка>
			+50% <иконка атаки>
		ok. отображать у связанных характеристик иконки 
		ok. звук улучшения 
		ok. анимация улучшения 
			Builder можно подключить с анимацией 
				есть проблмеа в циклических зависимостях - Cannot access 'actionCreators' before initialization
					при добавлении Builder в Upgrade - возникает ошибка 
						Upgrade юзается в Game, BuildingButtons, Menu
							если убрать Upgrade из BuildingButtons то всё ок, но тогда и окно апгрейда не появляется 
							если убрать только из Game и Menu то ошибка остаётся
							а зачем оно нужно в Game и в Menu ?
							если убрать все зависимости из Upgrade то ошибка остаётся 
						Builder юзается в Game и в TestPage (если в обоих убрать то ошибка остаётся)
							если убрать из него Game и Buildings то всё ок
						BuildingButtons
							он юзается в Game, Building, Buildings, Menu, Upgrade
								Building есть в Upgrade и в Builder 
									Buildings есть только в Builder 
									Menu Нигде нету 
									Game есть только в Builder (если убрать - ничего не меняется)
							если убрать Building из BuildingButtons то ошибка остаётся

						Game так же нельзя заюзать из Upgrade - ошибка та же
				ok. как вариант можно Buildings.all передавать как параметр в Builder.mouseLogic
					Game.loadResourcesAfterBuild можно по идее тоже передавать как параметр
		ok. проверка на стоимость и баланс 
			ok. disable кнопку если нехватает монеток
		ok. отображать некий предмет после улучшения на строении (по координатам) означающий что улучшение проведено 
		ok. отображать купленное улучшение как disabled 
			и подумать как можно его отображать в поощрительном виде, что бы была гордость за покупку, а не пустота от disable
ok. железные шипы для баррикады
	ok. добавить логику уменьшения урона 
	ok. добавить тесты для баррикады апгрейденой: 2 баррикады и 2 зомби, одна апгрейдится через пару сек, через ещё пару сек появляется 2 кабана для каждой баррикады
fixed. звук начала новой волны 
	щёлканье затвора хоть и визуально соотноситсяя и заполняет пустота - но является негативным военным элементом, что для детской игры - лишнее
ok. для большего выбора действий можно добавить прочкаку брони на 0.1 за x2 стоимости
ok. стрелы с динамитом 
	ok. если прокачена огненные стрелы, то этот cкилл будет чередоваться с огненными стрелами (одна стрела горящая, другая с динамитом)
	ok. при попадании в землю, стрела должна взорваться
	ok. урон монстрам в радиусе	
		algorithms like k-d tree or spatial indexing libraries to make it more efficient.
	ok. затестить большой радиус взрыва - насколько сильно будет видно 2x радиус урона и анимации?
		ok. анимация расплываетс, нехватает разрешения картинки (при dynamitRadius = 150 ещё норм)
			ok. но зато она чётко ложится в радиус взрыва 
		ok. урон выходит дальше взрыва, надо до 1.5 уменьшить
ok. добавление огненных стрел (поджигают монстров) + к внешнему виду башни добавляется огненое жерло анимированное
	ok. при попадании в землю, огонь должен вертикально гореть 
	ok. при попадании в монстра, должна поджечь его
	ok. при повторном попадании - должно обновить время жизни 
		canceled. усилить урон
	ok. распространение огня должно передавать время жизни и урон (если время жизни больше или урон больше, то нужно взять большее значение)
		fixed. выглядит не очень, он передаётся визуально странно и быстр осильно и исчезает так же внезапно
			fixed. идёт горящий зомби, взади ещё 2 обычных, пробегает кабан мимо первых двух, на третем поджигается и задней частью туловища поджигает двух других зомби, всё это на быстрой скорости - странно визуально выглядит 
				canceled. нужно добавлять анимацию перекидывания огня 
				ok. и время задержки от начала заражения до первой возможной передачи
			ok. уменьшена область монстра для передачи огня - теперь выглядит норм - когда монстр задевает огонь - тогда он и загорается
			ok. + учтён огонь по высоте - благодаря чему - летучие мышки поджигают мышей выше
		canceled. при затухании добавить доп анимацию 
			canceled. + если с первой стрелы убивает мышку то тоже воспроизводить анимаци затухания
		ok. нужно внешний размер менять
		> при попадании огненной стрелой по мобам - можно добавить доп анимацию - расхождение небольшого огненного шара, который поджигает рядом стоящих монсров даже если убивает текущего монстра с 1 раза
		fixed. иногда проскакивает баг для кабана, что у него огонь отображается выше чем сам кабан
			this.lifeTimeMs > this._lifeTimeMsInitial из-за чего scale  доходит до 3.5 хотя олжен быть максимум 1 
		> иногда всё-таки нехватает анимации передачи огня, но я не представляю как это сделать, многие анимации будут глупо выглядеть.
			дыхание огня?
			прыгающий огонь?
			тупо переместить столп огня?
			переместить с изменением размеров в виде моста? 
	для экономии времени разработки - оменяется добавление двух анимаций для огня 
		расхождение пламени при попадании стрелой в цель (дабы показать почему загораются соседние летучие мышки)
		расхождение потухшего дыма от затухания огня 
ok. скиллы 
	ok. улучшения
		ok. добавить время жизни огня 
		canceled. добавить процент накладываемого урона при добавлении огня (башня стреляет второй раз по горящей толпе - сейчас урон не увеличивается. лишь восстанавливается, а можно сделать % накладываем урона)
		canceled. сделать что бы не каждая стрела была такой, а лишь в % и  что бы можно было прокачивать процент таких стрел
			> Нужно поэксперементировать с этим - может это и вовсе не нужно?
				1 через 1 - вполне норм справляется башня 
				> это будет выглядеть как недокупленная вещь, проданная пустышка. хотя если 1/3 может ещё норм будет. 1/5 - уже непонятно. 1/10 - точно не стоит того.
		ok. добавить прокачку увеличения урона этими видами стрел 
		ok. для динамита добавить прокачку радиуса взрыва
skip. при открытии окна улучшения баррикады или башни какое то безумное падение фпс происходит до 6 - после закрытия окна улучшения - нормализуется до 60
	> при стрельбе огненными стрелами - та же история
	> в тестах то же появились зависания - что происходит? такого небыло в прошлый раз при тестировании огня
	> на старых коментах до Improvments ветки, от которо она взята, на v0.7, на v0.5 - на которых всё было ок, сейчас та же проблема, фпс до 8 падает при открытии окна улучшения строения 
		причём в самой игре - всё норм, нет зависаний, даже на третей волне с динамитом - всё ок 
		но с огнём виснит
			нужно проверить: дело ли там в картинке огня?
				да, из-за картинки, что интереное - сократив до 7 фреймов огня - он выглядит даже красивее чем с 35 фреймами

		переутановка хрома с удалением всех пользовательских данных - совершенно не помогла - может дело в версии хрома?
			после обновления firefox - там та же проблема появилась
				будем ждать пока пофиксят - я репорт в хроме отправил
		что такого мощного в окне улучшения строений?
			1 строчка в Building вызывает зависания: Building.upgradeAnimation.draw(drawsDiffMs, isGameOver, x - this.width / 2, y - this.height / 10, this.width * 2, this.height + this.height / 10)
				без этой строки фпс стабильно 60
				при вычлинении всей логики - только рисование - все равно до 5 падает фпс - кажется проблема в размере изображения 2мб 35820 пикселей в ширину
				уменьшение картинки в 2 раза до 17910 пикселей в ширину и 1.76мб - увеличило фпс до 13
				уменьшение картинки до 10 кадров 3980 пикселей в ширину - 375кб - увеличило фпс до 60
				взял исходное изображение - удалил всё с него - стало весить 11кб - фпс падает до 8 - проблема в ширине картинки, канвас перестал справляться с вырезкой картинки
ok. не давать строить у границ экрана за 100 пикселей
ok. при окончании хп самой земли - сделать взрыв сверхновой на весь экран
fixed. с выключенным звуком поставил на паузу (через Esc) в момент взрыва баррикады, потом попытался снять с паузы через Esc - но ничего не вышло. в консоли ошибка: 
		The time must be greater than or equal to the last scheduled time
		at AudioSystem.ts:293:1
	так же в консоли много предупреждений: 
		Debug.ts:62 The AudioContext is "suspended". Invoke Tone.start() from a user action to start the audio. 
	с паузы удалось снять кликом мыши по крестику, но звук появился и я не могу его отключить 

	проблема время от времени воспроизводится при паузе с отключенным звуком
ok. добавить сохранение выключенного звука хотя бы в sessionStorage + при возврате с другой вкладке - включать звук только если он был включен
	fixed. при возврате с другой вкладке отображается выключенный звук, хотя он включен
ok. фпс просел до 25 на четвёртой волне
	на старых проверенных версиях так же - на тот момент я сидел за ноутом который почти разрядился
		при подключении провода зарядки - фпс увеличился до 90 - видимо requestAnimationFrame берёт частоту обновления экрана
fixed. скелетон в 14-ом тесте тоже не прогружается или точней он распологается непонятно где
	y = NaN
	Waves -> logic -> monster.y = 
	monster.y == NaN
	bottomPosition == NaN
	monster.height == NaN 
ok. возможно стоит заменить hover на проверку по альфа каналу пикселя изображения атакуемого монстра?
	всё ок, нашёл производительный вариант. минус - может по производительности много стоит 
		1 раз на цикл высчитывается альфа канал под курсором - если он меньше 200 - то значит нет объектов и мы даже не обрабатывает логику мыши для объектов 
	cancel. средний подход: автоматом высчитывать hover по каждому краю для изображения/анимации 
	cancel. средний подход со скосом: составлять матрицу допустимого наведения на монстра, что бы каждый раз не доставать пиксель изображения
		cancel. таких матриц будет несколько и этой будет массив матриц для каждого случая (бег, атака, спец способности)
fixed. во время строительства, если навести на существующее строение, то отобразятся кнопки улучшения, при клике на которые откроется панель улучшения, а здания для строительства будет дальше висеть на мышке
	ok. можно либо кнопку улучшения не отображать и ремонта 
	> либо при клике на них - убирать режим строительства
fixed.  редкий баг: звук щита некроманта иногда не пропадает при заходе в меню (долгое удержание)
				при убистве монстра под щитом - звук остаётся
				иногда не продлевается по звуку - хотя визуально держится
		_soundsForPause - is empty
fixed. стрела с динамитом врезалась в летучую мышь, но взрыв отобразился значительно дальше по траектории
воспроизвелось только 1 раз (летучая мышь была над башней) - в остальных случаях всё норм, если у Земли летучая мышь то норм, если перед башней - то норм 
	когда ближе к центру башни, то есть некоторые отклонения во взрыве (дальше по траектории) - или может это не с этим связано? но если взрыв из-за существа - то стоит в пределах существа взрыв отображать
не воспроизводится. после нажатия на ремонт не отображаются кнопки управления соседним зданием, которое накладывается на это
fixed. если game over настаёт раньше чем скелеты успели вылезти, то они исчезают - надо что бы просто застыли на месте
ok. волна 4. некромант с посохом, 
	ok. скелетоны.
		поднимая посох вверх, тот набирается зелёной силы от основания до верху и затем нейкромант резко падая на колено ударяет вертикально посох о землю, зелёная магия быстро обратно уходит сверху вниз, в землю 
		и затем если впереди нет зомби, то с зелёной магия появляются 3 скелета с мечами (слабые, но большой урон)
		если есть зомби, то магия зелёная снизу по ним поднимается и заменяет зомби на скелетов с мечом 
			ok. добавить 3 вида скелетов - 1 модель - 3 окраски
				ok. добавить анимацию вылазивание скелетов с магией из под земли
					ok. 1
					ok. 2
					ok. 3
					ok. 4
				ok. скелеты быстро бегают (анимация бега)
					ok. 1
					ok. 2
					ok. 3
					ok. 4
				ok. и много урона наносят (анимация атаки)
					ok. 1
					ok. 2
					ok. 3
					ok. 4
			canceled. добавить звук скелетов 
			canceled. убрать обнуление счётчика обычных атак при получении урона?
			canceled. за склелетов не давать золота ? или дават ьминимально мало - 1 монетку
				пока это не критично, да и фармить золото можно и без этого - просто долбя землю пока некроманты бьют здание которое чинят инжинеры
			ok. создать анимацию вызова скелетов от некроманта
			ok. добавить звук вызова скелетов
			ok. добавить звук вылазиния скелетов из под земли
				ok. ещё добавить рёв: ваааа, увээээ
			ok. Добавить звук получения урона скелетами
				удары по костяшкам
			ok. нужжно повысить статистику "кол-во монстров" на волне, при создании скелетов
				Wave
				при этом нужно избежать цикличной зависимости Wave - Necromancer -> Wave
			ok. уменьшить зону наведения по высоте пока скелет появляется
				добавлена система проверки альфа канала для пикселя
	ok. может ему ещё и магию щита зелёного сделать? что бы он закрывался при атаке за него на 3 сек
		ok. при продолжении атаки - магия продлевается
		ok. нехватает анимации снятия щита
		ok. модификатор защиты надо раньше включать
		ok. добавить звук жужжания электричества и магии
			ok. сделать звук циклическим
				ok. при пересоздании надо както объект менять - но лучше текущий объект перезапустить. restart? 
			ok. source.autostart = true;
	ok. стреляет зелёной магия из посоха на расстоянии 
		ok. обновить анимацию посоха при ходьбе 
		ok. обновить анимацию посоха при стрельбе
		ok. Добавить пару кадров в анимацю, а то очень глюково выглядит
		ok. добавить звук электричества во время начала анимации, а то нехватает звука
		ok. переделать анимацию - начинать с плавного подъёма посоъха и начала электричества более плавное (сейчас он резко поднимает посох уже с электричеством)
			ok. попробовать пока 2-3 кадра добавить в начало анимации с нарастанием электричества
	ok. звук ругательства при клике по нём
	ok. иногда вызывает 1 из 2-х более мощных заклинани
	ok. с огнём надо уметь бороться
		ok. Добавить анимацию 
		ok. добавить логику активации - если есть FireModifier прикреплённый
		ok. огонь сбоку отображается, надо подвинуть
		ok. добавить логику сбивания заклинания вызов кислотного дождя если наносится урон (огнём, стрелок башни, игроком)
		ok. можно сделать вспышку зелёной магии в посохе некроманта на середине смахивания огня 
			так что бы оно совпало с исчезновением огня
	ok. кислотный дождь (снимает бафы, накладывает 2 дефаба: уменьшение брони и постепенный урон кислотой)
		некромант поднимает двумя руками посох над головой горизонтально, постепенно вокруг посоха начинает зелёная и тёмно облачная магия крутится, одновремнно с этим, над целью появляется растущее облако 
		если некроманта сбить, то облако так же уменьшится и исчезнет, иначе облако вырастет и будет поливать кислотой и немного молниями сверкать, а некромант закончит анимацию и продолжит стрелять зелёной магией
		ok. отменяется при получении урона 
		ok. отменяется при уничтожении здания
			ok. проверить кабана - у него отменяется спец способность при уничтожении здания?
				он бежит дальше - и таранит канат - ок
		ok. отменяется при завершении волны - добавить тест 
		ok. модификатор
		ok. исчезает через n времени
		ok. наносит урон каплями кислотными - генерирует n штук в секунду
		ok. профиксить - на четвёртой волне (в отдельном тесте - всё норм) 
			ok. при атаке - увеличивается некромант в размерах 
			ok анимация появления облака запаздывает, а потом враз проигрывается
			ok иногда вообще зависает анимация атаке в конце и нету обычной атаки 
			ok иногда облако с анимацией появления и вовсе не появляются
		ok рандом должен работать по кол-ву совершённых атак (сработать на N атаке) потом аздаётся новый N 
		ok. при смене цели - сбрасывать атаки
		ok. sizeScale не учитывается при атаке
		ok. добавить звук грома
		ok. Добавить звук дождя
		ok. добавить в модификатор - усиление урона

ok. в режиме строительства при наведении нового здания на уже построенное - применяется фильтр в canvas: Draw.ctx.filter = "grayscale(1) "
	из-за чего фпс проседает и это заметно 
	было бы хорошо один раз модернизировать изображение здания с фильтром и сохранить его в переменную, а потом просто юзать если надо
	
		фильтр не применяется ни для get/putImageData
		ни для OffscreenCanvas
			if(filter in this.filteredImages){
				console.log('draw filtered');
				Draw.ctx.drawImage(this.filteredImages[filter], invertSign * x, y, invertSign * this.width, this.height);
			}
			else {
				console.log('create');
				//create filtered image
				this.filteredImages[filter] = new OffscreenCanvas(this.width, this.height);
				let context = this.filteredImages[filter].getContext('2d');
				if(context){
					console.log('create - draw in context');
					context.filter = filter;
					context.drawImage(this.image, -this.width * 2, -this.height * 2, this.width, this.height);
					context.filter = 'none';
				}
				console.log('create - end');
			}
		no. нужно делать свои фильтры 
			оказывается я сверху оригинал перерисовывал - забыл убрат ьв else блок код
			
	
	ok. при апгрейде здания так же накладывается фильтр: Draw.ctx.filter = 'brightness(1.7)';
	ok. во время кислотного дождя фильтр: Draw.ctx.filter = 'hue-rotate(40deg)';
	можно попробовать после загрузки изображения - отрисовать его за пределами canvas с фильтром, 
		а затем вырезать изображение и сохранить в переменную
		это должно быть общим решением и под разные фильтры
fixed. после строительства здания - оно появляется выше чем было показано пр истроительстве
	Building.ts -> logic:
		if(this.y + this.height > Draw.canvas.height){
			this.y = Draw.canvas.height - this.height;
		}
	этот код выталкивает здание выше		
ok. канат от земли не догружается по image Handler
	из-за этого он появляется на 100 пикселях примерно вверху на тестах
	[воспроизводится только при горячей перезагрузки кода]
	ok. пофиксено - нужно проверить (скопировал выставление координат каната в загрузку FlyEarch дополнительно,
		т.к. кажется что канат загружается быстрее земли, поэтому такой эффект наступает)
ok. каждый кристалл нужно обрезать по краям ровненько и отображать на нужном месте по его заданным координатам
	18Кб весит каждый кристалл сейчас
	9.75Кб весит обрезанный кристалл
fixed. на одно и то же крайнее место можно разместить бесконечное количество башен, если мышку к краю увести
ok. Unit - перенести общий код в более абстрактный класс AttacketObject, а весь оставшийся код и AttackedObject переместить на уровень выше для Monster, Building в AttackedMonster, AttackedBuilding класс 
ok. оптимизировать взрыв земли - обрабатывать только часть частиц за раунд 
	> испробовать 2 способа
		> 1 - отрисовывать периодами по N элементов
			если при этом способе не будет обнаружено рывков частиц, то можно на нём и остановиться
		> 2 - отрисовывать рандомно по M или N элементов 
		N - количество элементов, при котором не будет замечено снижение fps 
		M - то же самое, но для рандома (вызов рандома может снизить производительность)
	reason: не получится, т.к. частицы движутся и фильтруются в процессе отрисовки - если убрать, то и сама отрисовка пропадёт.
		> в таком случае поможет только отключение системы затирания всего холста
			> либо частицы создавать не все, а рандомно под заданное количество
				сейчас их 16218
				с 5k становится уже нормально - без лагов
			> либо метод 2 - разбивать изображение ровно на N частей, при котором не будет лагов
				const size = imgData.height * imgData.width / 5000;
				for (let i = 0, y = 0; y < imgData.height; y += size){
					for (let x = 0; x < imgData.width; x += size) {
		
				> Но тогда и частицы должны будут не цвет нести, а часть изображения своего размера

	Result: просадка фпс не была устранена, зато она сделана незаметной и красивой	- замедление применено ко всему
	
ok. при открытии магазина - звук щелчка появляется с небольшим запаздыванием - может сама дорожка имеет пустое пространство спереди?
	сейчас задержка вроде не сильно велика - можно игнорить пока + я обрезал звук на максимум
ok. добавить юнит тесты и визуальные тесты
ok. при наведении на ремонт здания, если монет не хватает - то надо подсвечивать их красным цветом на кнопке 
fixed.  передача импульса от кабана к башне пропала
fixed. появился баг обновления баррикады с деревянной на железную - спрайт меняется только после закрытия окна апгрейда 
	хотя размер меняется раньше.
	это из-за сохранённых фильтров 
ok. сделать список тестов прокручиваемым ( не вмещается на экран)
ok. поменять спрайт колдуна - он слишком зло выглядит - надо его лицо обновить - глаза и зубы
	ok. так же обновить скелетов
		skipped. 1
		ok. 2
fixed. импульс зданиям снова был сломан в комите " added UnitButtons and UpgradableObject"
fixed. импульс справа не передаётся зданию
fixed. скелеты невидимы
fixed. некромант после тушения себя - показывает анимацию прекращения щита
fixed. со звуком проблемы у некроманта: http://localhost:3000/test?v=34
		ok. AudioSystem.play(x, CoinGetSoundUrl, volume);
		AudioSystem.play(x, arrayPathesToAudioFiles[i], volume, speed, isUseBiquadFilterRandom, isMusic ? true : false, 0, 0, isMusic);
ok. в четвёртой волне сделать летучие мышки ток на время - до начала наступления всех монстров, а то весь процесс ими занят и не видишь новых монстров...
fixed. http://localhost:3000/test?v=43  Некромант - щит - сбиваем огнём - баг со звуком - звук щита продолжается, хотя он его убрал уже
	и затем звук зацикливается не исчезая	


	ok. золотодобытчик (с киркой на летающей земле)	
		ok. анимация падения на летающую землю 
		ok. анимация приземления
		ok. анимация приветствия
		ok. попробовать затемнить края золотодобытчика - что бы он не сливался с летающей землёй
			вроде выглядит лучше
			ok. убрать затемнение с ног, что бы они сливались с землёй, а то выглядит не очень, когда весь выделяется
		ok. кристаллы на летающей земле некрасиво смотрятся за золотодобытчиками
			ok. каждый кристалл должен быть отдельным + добавить в Units прорисовку отдельных кристаллов, если за ними кто-то есть 
			ok. составить карту на земле, где нельзя ходить и появляться + обновить логику появления + когда бегать будут от летучих мышей - учитывать эту карту 
		ok. добавить тесты
		ok. убрать с земли почтовый ящик, дерево справа и подвинуть дерево слева повыше 
			а то некрасиво смотрится, когда miner на них расположен
		ok. слишком близко появляются (первые 10 вообще должны распределённо быть друг от друга)
		ok. добавить логику, что бы майнеры не появлялись на кристаллах и не могли там находится 
			(для тестирования может выталкивающую силу добавить в Units ?)
			ok. вытеснение добавлено 
			ok. при создании проверять goalY и вытеснять его
				ok. разобраться с багом отображения кристалла в тесте "Золотодобытчик - Авто появление - на кристалле"
					возьмём тест "Золотодобытчики - перед кристаллами"
					изначально всё ок
					но стоит убрать появления двух последних майнеров
					и баг снова воспроизводится 
						ok. надо проверить логику отрисовки для этой ситуации и для ситуации когда есть ещё майнер 
						что заставляет логику отрисовывать этот кристалл если нет майнеров больше?
							ok. 2 майнера. баг. Units.ts:205 drawCrystal2 459.375 453 473 (crystal2YBottom, prevMiner?.goalY, nextMiner?.goalY)
								ok. отрисовка не там находилась - она была после отрисовки юнита, а должна была быть перед.
				ok. разобраться с багом вытеснения в тесте "Золотодобытчик - Авто появление - на кристалле" - не вытесняется
		ok. проверить корректность отображения кристаллов
			ok. 1
				ok. перед
				ok. за кристаллом
				ok. вокруг по элипсу
			ok. 2 
				ok. перед
				ok. за кристаллом
				ok. вокруг по элипсу
			ok. 3
				ok. перед
				ok. за кристаллом
				ok. вокруг по элипсу
			ok. 4
				ok. перед
				ok. за кристаллом
				ok. вокруг по элипсу
			ok. сейчас проверка в виде квадрата - но это не верно, лучше переделать под окружность
		ok. ограничить количество покупаемых юнитов - до 20 включительно
			23 башни - максимум удалось вместить
		ok. покупка майнеров должна тратить денюжку
		ok. анимация появления (чуть выше летающей земли)
			no.летящая душа летит от места клика на покупку к рандомному месту над землёй, 
				и там происходит магия появления человечка и его падение на землю 
			no. или сделать как с башнями - выбирать место где он будет стоять и добывать
				во время атаки - должен бегать от летучих мышек
			ok. портал или анимация магии появления
				ok. добавить вспышку при появлении золотодобытчика 
		ok. когда земля улитает - майнеры остаются в воздухе - а должны улетать вместе с землёй
		ok. сделать ноги у золотоботчика со ступнями, а то выглядит не очень
		ok. анимация бодрого ожидания (стар волны, но ещё не началась волна)
		ok. анимация добычи 
		ok. ограничение на количество?
			20 майнеров только умещаются на летающей земле без последствий
		ok. сделать некий рандом в копании майнеров, что бы не враз они долбили землю
		ok. когда земля взрывается - майнеры должны погибнуть
		ok. звук появления 
		ok. звук добычи слишком громкий и ниже 0.01 не опускается.
			sourceTone.volume.value = (gainNode.gain.value - 1) * 20; 
				//The volume of the output in decibels.
				примерно 60 децибеллов является 100% погошением звука - но лучше рассмотреть следующее:
			https://tonejs.github.io/docs/r12/Master Он предоставляет такие полезные удобства, как возможность устанавливать громкость 
				и отключать звук всего приложения. Один главный выход, подключенный к AudioDestinationNode (он же ваши динамики).
		canceled. звук приветствия - hey 
		ok. логика нападения летучей мыши на майнера
			bat слева, miner справа, bat летит к miner 
				bat.isLeftSide != miner.isLeftSide
			bat пересекает середину 
				bat.isLeftSide == true and != miner.isLeftSide
				bat.x < miner.x 
			bat догнал майнера 
				bat.x > miner.X    
			miner убегает на левую сторону 
				bat.x > miner.x     bat.x > miner.x + miner.width  меняем bat.isLeftSide
			bat пересёк середину 
				bat.isLeftSide !=  miner.isLeftSide
				bat.x > miner.x + miner.width 
			bat догнал miner 
				bat.x < miner.x + miner.width  and bat.x > miner.x
			ok. с маленьким шансом, летающие мышки выбирали целью - золотодобытчика 
				ok. анимация бега с отмахиванием от летучих мышек
					ok.либо просто бега
			ok. звук ай, - получение урона 
			ok.  добавить тест на уничожение летучей мышки через некоторое время 
				ok. майнер должен остановиться и продолжить копать в новом месте
			ok. добавить звук гибели майнеров - протяжное аааау
			ok. добавить анимация гибели
				no. майнер падает вниз 
				no. дух белых улетает вверх и исчезает плавно
					игра у нас для детей, поэтому нкиаких серьёзных смертей
					ok. заместо этого - покажим анимацию появления наоборот + 
					ok. появится статуя кирки, которая упадёт вниз как в червечках - желе образно
						при наведении на эту кирку - можно будет воскресить добытчика
			skip. добавить тест с несколькими майнерами и несколькими летучими мышами с разных сторон
				ok. проверено на волне 3
			ok. добавить тест на несколько мйнеров и одну летучую мышь - она должна сьъесть майнера на другой половине Земли 
				ok. цель - проверить что летучая мышь больше не нападает ни на кого - а бьёт только Землю
				fixed. в этом тесте есть баг - при нападении на нижнего майнера, он часто отрисовывает не ту анимацию/картинку 
					нужно рисовать run анимацию 
					а он рисует fall картинку 
				fixed. есть второй баг - с кристаллом - при начале движения - майнера кидает переди и за кристалл из-за рандомного движения
			ok. нужно кирку забрасывать одновременно с end анимацией
			ok. проверить как будет отреагировать башня на летучую мышь с другой стороны прилетевшую
			ok. проверить на быстром miner - как он будет успевать убегать от мышки и начинать копать
				ok. кажется надо уменьшать скорость летучей мышки когда она гонится за золотодобытчиком - после первого укуса
				
		ok. лечение майнера 
			ok. кнопка 
				ok. нужно при наведении показывать цену лечения
				fixed. есть баг - при лечении одного юнита - кнопки больше не появляются
			ok. анимация (сердечки)
				ok. можно сделать картинку сердечки одной и далее вручную делать рандомное появление их в области персонажа
			ok. звук 
				можно создание звука от добычи монеток скопировать и на создание сердечек поместить
			
		ok. воскрешение майнера 
			ok. звук 
			ok. анимация 
			ok. кнопка - та же с сердечком
				ok. бнит успешно сам опднимается без доп логики и машет рукой
			
		ok. кирку в земле - можно заюзать общую анимацию привлечения внимания
			ok. мерцание звёздочек маленьких появляющихся и исчезающих плавно поднимающихся вверз по дугообразной траектории как трава?
				
		fixed. баг: при наведении на кнопку лечения у кирки - потом кликнуть на починку башни, потом вернуться к кирке - кнопка активна, хотя монеток нехватает 
			кнопки сильно глючат между собой 
			ощущение что disabled свойство устанавливается и снимается очень запоздало
			UI отображается только раз, потом он всегда открытый и ререндерится фиг знает когда 
			можно либо при изменении количества монет у gamer менять redux state что бы перерендерить все элементы завязанные на монетках
			либо вручную ререндерить при том же условии 
			либо ...
			
		ok. добавить анимацию радости при окончании волны
			canceled. танец локтями
			ok. радостные прыжки и махание руками
				
		ok. добавить прокачку скорости (добыча монеток, бег)
		
		fixed. урон от летучей мыши не с той стороны отображается
			isLeftSide нарушен?
		
		ok. задать this.isRunRight = true; при joy 
			
		ok. прокачка навыков
			ok. пассивки
				ok. скорость добычи
				ok. здоровье		
				
			ok.  инструменты (
				ok. золотая кирка (x2)
					ok. баг - 2 майнера, один с золотой киркой - другой нет. при смерте обоих - 2 золотые кирки в земле 
						изображения передаются ссылочные, поэтому просто менять src нельзя - он меняется у статичного класса 
						на момент передачи изображений - src в тесте был незагружен
				ok. алмазная кирка (x3)
				cancel. потом бур (x3 монет - за то же время - но выглядит равномерным появлением)
					отменено т.к. не понятен какой он эффект даёт - скорость прокачивается уже отдельным параметром
					а трудности связанные с его добавление - превышает нулевой эффект
				ok. прокачивается скорость добычи
				
			ok. самооборона
				ok. анимация махания киркой для атаки по летучим мышам если на него напали
					cancel. а если прокачен до бура? махать буром?
					ok. gold pick 
					ok. diamond pick 
					ok. скорректировать время ударов 
					ok. скорость должна влиять и на attackAnimation и на время ударов 
					ok. проверить увеличение урона 
					
			canceled. прокачка урона - конфликт с типом инструмента - зачем сила буру?
				это не атакующий и не обороняющий тип юнитов  - ему урон ни к чему.
				а если инструмент + сила прокачивается?
				и для самообороны и для количество выбиваемых монет ?
				ok. добавлено для самообороны
					
			ok. одежда для повышения брони майнера
				ok. деревянная (броня на 0.8 повысить)
				skipped. железная (броня до 2 повысить)
					сейчас не нужно... нет таких противников
				canceled. может сама прокачается если прокачать броню на 10 пунктов?
		
			ok. нужен эффект от апгрейда юнита - может у зданий скопировать?
				
		ok. заменить картинку во время отдыха на анимацию небольшого/малого движения
			ok. добавить применения фильтра на анимацию (усовершенствование майнера должно подсвечивать его)
			ok. Обновить анимацию кирок 
				ok. gold 
				ok. diamond 
			ok. обновить анимацию брони 
fixed. апгрейд юнита воспроизводит анимацию на всех юнитах
	+ она теперь быстрее воспроизводится
		static upgradeUnit(unit: Unit){
			this.smokeAnimation.restart();
		}
		тут unit никак не задействован. и анимация для каждого воспроизводится
ok. задать точку возврата майнерам в мирное время если их летучие мыши вынудили убегать
	ok. лучше сделать это для всех юнитов
	
ok. майнер при драке - двигается, что позволяет ему выйти за пределы земли 
ok. нужно поменять способ работы защиты - на четвёртой волне - могу не могут пробить обычную баррикаду с прокаченной защитой	
	> либо удорожить её, либо не сбивать урон полностью - а пропускать хотя бы 10%
	ok. можно ещё прогрессивную стоимость ввести
fixed. если здания близко к краю - то некроманты атакуют за пределами карты
	
	ok. золотособирателей 
		ok. вручную нагинается и подбирает монетки 
		ok. при получении урона - убегает от монстров 
		ok. если зажали с двух сторон - то садиться и руками прикрыть голову для повышения защиты на 0.1
			ok. анимация shield
			fixed. есть моргание при диактивации защиты
			
		ok. анимации
			ok. passive waiting 
			ok. fall 
			ok. fall end 
			ok. run 
			ok. collect 
			ok. shield
			ok. joy
				
		ok. тесты 
			ok. юнит собирает ближайшие монетки 
			ok. монстр подходит к собирателю, который просто стоит
			ok. юнит убегает за здание - монстр должен поменять цель на здание 
			ok. юнит появляется перед зданием - монстр должен поменять цель на юнита 
			ok. монетка упала за монстром 
				ok. монетка лежит рядом с монстром бьющим здание 
				ok. сбор монетки которая исчезает до того, как её успевает собрать юнит
				fixed. после ухода юнита от монстра - возникает странный баг - юнита колбасит и оттодвигает от центра карты 
					срабатывает поочерёдно 2 противоположные логики движения: 1 и 3
			ok. монстр перехватывает монетку к которой идёт собиратель 
				fixed. пойман баг - юнит не убегает, а почти стоя перемещается от монстра - почему нет анимации бега?
				fixed. пойман баг - когда монетку собирает монстр - юнита все-равно несёт к месту монетки, хоть уже и без анимации бега
				fixed. нужна небольшая задержка для бега после сбора монетки
				ok. есть ещё монетки 
				ok. монеток больше нету
			ok. 2 монетки с разных сторон в радиусе сбора - после первой - поменять цель на вторую
				fixed. слишком быстро направление движения меняется у юнита - он ещё не успел встать, а уже смотрит в другую сторону
			ok. два монстра окружают собиратели между баррикадой
				ok. баррикада ломается
					ok. добавить анимацию shield, startShield, endShield как у некроманта с продлением эффекта щита при атаке
			ok. зажали с двух сторон
			ok. окончание волны с монетками на карте - юнит продолжает собирать монетки
				fixed. анимация становится Passive после окончания волны согласно логике в Units.drawObjects 
			ok. добавить тест смены цели
				fixed. юнит идёт к дальней монетке, но вблизи него падает новая - нужно поменять цель
			ok. окончание волны без монет на карте - юнит радуется
				ok. joy
			
		ok. прокачивается скорость (передвижения и сбора)
			fixed. все улучшения куда то исчезли
			
		ok. есть баг-фича: если монетка исчезает до момента сбора и при этом у майнера сбор активирован, то он соберёт следующую монетку автоматом, даже если она находится очень далеко 
			не стал фиксить - что бы не травмировать психику игроков - очень даде классно выходит - любой сбор приносит монетки
				
		fixed. после воскрешения - появляется в земле
		fixed. Bitmap подвисает
		
		cancel. появление так же нужно распределить, что бы не появлялись на одной стороне 2 собирателя
		
		ok. добавить тест на проверку распределения 2-ух, 3-х собирателей на карте во время небольшого темпа выпадения монет 
			иногда они кучкуются вместе, до полного сливания воедино при сборе монет
			
		ok. нужно добавить динамичную систему маятников - при котором собиратель будет склонен к монетам в своей зоне влияния
			ok. и добавить систему равномерно распределения маятников при покупке новых собирателей
			ok. ограничить собирателя своей зоной, что бы не уходил за чужими монетами
			ok. добавить событие падения монетки (первого касания земля), что бы только при этом событии собиратели снова пересчитывали растояние до ближайшей монеты
			fixed. баг: если начать волну до того, как юнит дойдёт до своего месте, то его заглючит и он будет бежать на месте не двигаясь до своего места
			
		ok. можно прокачивать инструменты сбора (
			ok. деревянная броня 
			cancel. тележка - позволяет автоматом собирать монеты, которые упали сверху 
			ok. пылесос - позволяет без наклонений собирать монетки - проходя их пешком
				ok. звук
					почти пофиксено :D есть прерывания при исполнении 
					ok. нужно паузить при заходе в меню,
				fixed. есть глюк в отображении
					http://localhost:3000/test?v=74
					если самостоятельно купить всё, то будет другой глюк - собиратель стоит без пылесоса в passive waiting
				fixed. если монет нет, то замирает на последнем кадре анимации StartCollecting
					else if (!this._goalCoin && this._isHasVacuum){
						this._startCollectingVacuumAnimation.restart();
						
					стадии анимации:
						passiveWaiting  -> run to goal -> start collecting -> collecting -> end collecting -> run to next goal OR passiveWaiting
						
					проблему нет без пылесоса
						
				ok. деревянную броню отдельно переделать надо 
				ok. анимация run - двух видов - убегание от врагов и пылесосить
					ok. пылесосить когда расстояние до монетки совсем небольшое остаётся
				
		ok. скорость должна влиять на скорость доставания пылесоса		
				
		cancel. если юнит собиратель один, то после окончания волны - сместить его goalX на центр ?
		fixed. устранить глюк в начале волны - анимация сбора включается при остутствии монет на пару секунд
			ok. анимация чесания головы включается теперь
		fixed. при окончании волны - заедает собирателя
		fixed. при падении монетки прямо на сборщика - нету этой замедлённой анимации начала пылесоса
		fixed. анимация при убегания + скорость -  дёргается
		fixed. защита - дёргается как зомби, так и сам собиратель
			от этого можно добавить только таймер по которому монстр может с атаки вернуться на движение и обратно
			fixed. у кабанов спец способность слетела
		fixed. пылесос при гибели слишком большого размера улетает 
			AttackedObject - нужно передавать размер оружия для отрисовки - или отрисовывать отдельным методом
		fixed. добавить тест: сбор монет после воскрешения после окончания волны 
			там Shop image отображается почему то
	ok. тележка-пылесос - позволяет притягивать для всасывания монетки на пути следования юнита 
		ok. увеличение мощности всасывания для притягивания монеток издалека 
		ok. логика
			ok. гибель
			ok. joy
			ok. fallEnd
			ok. притягивания монет спереди
				ok. форма притягивания - треугольник 
					ok. визуализировать для прокачки
					ok. сила притяжения
					ok. дальность
					ok. иконки для улучшений
					ok. придать больший вес монетам, находящимся в скоплении
						(если выбор стоит между более близкой 1 монетой и более далёкими 5 монетами - то нужно ехать к 5-ти монетам)
						1370
						1723 - новая логика
						1731 - старая логика 
						1763 - обновлённая новая логика
				ok. монеты сверху автоматом собираются на половине высоте сборщика
				fixed. баг: если 2 майнера и одного обновляем - то ширина у второго обновляется до размеров первого 
			ok. защита (defense, startDefense)
				ok. логика отталкивания монстров от центра ценой своей жизни
			ok. sound
			fixed. ошибка после воскрешения http://localhost:3000/test?v=87 кликнуть на апгрейд пока сердечки поднимаются
			ok. wood Armor
	fixed. если начать игру не дождавшись окончания fallEnd анимации, то после начала волны - эта анимация будет доиграна - нужно обнулить её при начале волны в Unit 

	fixed. проблема общего в классе:
		Collector. improveToVacuumCar. 
			this._fallEndAnimation.image.src = CollectorFallEndVacuumCarImage; 
				этот код приводит к изменению картинки this._fallEndAnimation во всех существующих экземплярах класса
			потому что Image передаётся статичный от класса
			берём только src от входного параметра - а смо изображение - пусть всегда будет новым объектом
			что бы не затиреть старое изображение
			но нужно проверить это поведение на загрузке картинки -если мы это провернём на момент загрузки - будут ли последствия?
				скорей всего изображение будет загружено 2 раза.
				
				fixed. решение это проблемы породило другую проблему - картинка установленная в момент недогруза - остаётся незагруженной 
					из-за этого персонаж не отображается - он невидим
			
	ok. collector плыл к своему месту после воскрешения 
		не воспроизводится		
	ok. заменить frequencyCreating на Duration - т.к. неудобно, что кто то из монстров ещё долго создаётся, хотя остальные уже всё.
		//1000 * 60 / waveData.frequencyCreating * count
	ok. сделать прогрессивным цену на улучшение парамтеров
cancel. приоритет на атакующих монстров для башни с несколькими лучниками
	fixed. изучить баг, почему не атакует близкую летучую мышь, а выбирает дальние
fixed. пофиксить баг с динамитом в стреле - он взрывается дальше места гибели монстра при большой скорости стрелы
fixed. после улучшения постройки или оживления юнитов - при наведении на соседние здания/юниты - у них не сразу появляются кнопки 
	нужно на событии mouseOut проверять - не находимся ли мы на другом здании, где нужно отобразить кнопки?
		так же можно посмотреть в сторону mousemove если вдруг не сработает на 100% с mouseOut
fixed. местоположение кнопок при наведении (оживить/улучшить) - не учитывает текущий скролл на странице
cancel. возможность сбивать снаряды некромантов кликом мыши ??
	но тогда можно фармить землю оставив одного некроманта
fixed. http://localhost:3000/test?v=72
	баг когда убигает от второго зомби справа - он толкает левого зомби, а щит не активируется
ok. добавить пылесос машине анимацию защиты - во время толкания монстров - что бы было понятно, что это не баг.
ok. создавать монетки от земли на разной высоте - это пофиксит странность для gold/diamond picker
	отрисовка прямоугольной системы:
		let flyEarth = Buildings.flyEarth;
		let coinX = flyEarth.x + flyEarth.reduceHover * 2 + Math.random() * (flyEarth.width - flyEarth.reduceHover * 4);
		let coinY = flyEarth.y + flyEarth.height / 2 + Math.random() * (flyEarth.height / 2 - flyEarth.reduceHover * 2);
		for(let xx = flyEarth.x + flyEarth.reduceHover * 2; xx < flyEarth.x + flyEarth.reduceHover * 2 + flyEarth.width - flyEarth.reduceHover * 4; xx += 4){
			for(let yy = flyEarth.y + flyEarth.height / 2; yy < flyEarth.y + flyEarth.height / 2 + flyEarth.height / 2 - flyEarth.reduceHover * 2; yy += 4){
				Draw.ctx.fillStyle = 'red';
				Draw.ctx.fillRect(xx, yy, 1, 1);
				Draw.ctx.fillStyle = 'red';
			}
		}
	отрисовка треугольной системы:
		for(let xx = flyEarth.x + flyEarth.reduceHover * 2; xx < flyEarth.x + flyEarth.reduceHover * 2 + flyEarth.width - flyEarth.reduceHover * 4; xx += 2){
			var yMin = flyEarth.centerY + (flyEarth.width - Math.abs(flyEarth.centerX - xx)) / 7 - 25;
			var yMax = flyEarth.centerY + (flyEarth.width - Math.abs(flyEarth.centerX - xx)) / 1.4 - 130;
			for(let yy = yMin; yy < yMax; yy += 2){
				Draw.ctx.fillStyle = 'green';
				Draw.ctx.fillRect(xx, yy, 1, 1);
				Draw.ctx.fillStyle = 'green';
			}
		}	
cancel. добавить возможность перемещать панели
cancel. если высота экрана не позволяет поместить доп панели 2 и 3 - то ограничивать этот функционал и функционал покупки магии	
cancel. на изображении магии нужно ещё отображать её характеристики вкратце 
	(если игрок покупает одну и ту же магию - но по разному её апгрейдить - нужно понимать по картинке - где какой вариант)
	> может урон отображать?
	> но для огненого дождя ещё и длительность важна - а для метеора нет.